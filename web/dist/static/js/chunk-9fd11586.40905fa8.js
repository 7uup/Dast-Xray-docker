(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9fd11586"],{"0ccb":function(t,e,n){var a=n("50c4"),r=n("1148"),s=n("1d80"),c=Math.ceil,i=function(t){return function(e,n,i){var o,u,l=String(s(e)),d=l.length,f=void 0===i?" ":String(i),g=a(n);return g<=d||""==f?l:(o=g-d,u=r.call(f,c(o/f.length)),u.length>o&&(u=u.slice(0,o)),t?l+u:u+l)}};t.exports={start:i(!1),end:i(!0)}},"0f97":function(t,e,n){},1148:function(t,e,n){"use strict";var a=n("a691"),r=n("1d80");t.exports="".repeat||function(t){var e=String(r(this)),n="",s=a(t);if(s<0||s==1/0)throw RangeError("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(e+=e))1&s&&(n+=e);return n}},"1c4b":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"scanner-container"},[n("el-card",{staticClass:"header-card",attrs:{shadow:"hover"}},[n("div",{staticClass:"header"},[n("div",{staticClass:"title-area"},[n("i",{staticClass:"el-icon-aim title-icon"}),n("h2",[t._v("openapi扫描任务管理")])]),n("div",{staticClass:"header-buttons"},[n("el-button",{attrs:{type:"success",loading:t.refreshing,icon:"el-icon-refresh"},on:{click:t.refreshTaskList}},[t._v(" "+t._s(t.refreshing?"刷新中...":"刷新任务")+" ")])],1)])]),n("el-card",{staticClass:"table-card",attrs:{shadow:"never"}},[n("el-divider",{attrs:{"content-position":"left"}},[n("i",{staticClass:"el-icon-tickets"}),t._v(" 任务列表 ")]),t.taskList.length?[n("el-table",{staticClass:"task-table",attrs:{data:t.taskList,border:"",stripe:"","highlight-current-row":""}},[n("el-table-column",{attrs:{align:"center",label:"ID",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}],null,!1,811300409)}),n("el-table-column",{attrs:{prop:"name",label:"任务名称","min-width":"160","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"url",label:"扫描URL","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{label:"创建者",width:"120",align:"center"}},[[t._v("管理员")]],2),n("el-table-column",{attrs:{label:"状态",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{size:"small",type:1===e.row.status?"warning":2===e.row.status?"success":"info"}},[t._v(" "+t._s(t.getStatusLabel(e.row.status))+" ")])]}}],null,!1,3373575889)}),n("el-table-column",{attrs:{prop:"create_time",label:"创建时间",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.formatDate(e.row.createtime))+" ")]}}],null,!1,3993364730)}),n("el-table-column",{attrs:{label:"操作",width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-dropdown",{attrs:{trigger:"click",placement:"bottom"}},[n("el-button",{attrs:{type:"primary",size:"mini",plain:""}},[t._v(" 操作"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{icon:"el-icon-video-pause"},nativeOn:{click:function(e){return t.stopTaskById(a)}}},[t._v(" 停止 ")]),n("el-dropdown-item",{attrs:{icon:"el-icon-view"},nativeOn:{click:function(e){return t.goToDetail(a)}}},[t._v(" 查看详情 ")]),n("el-dropdown-item",{attrs:{divided:"",icon:"el-icon-delete"},nativeOn:{click:function(e){return t.deleteTaskById(a.id)}}},[t._v(" 删除 ")])],1)],1)]}}],null,!1,3550416232)})],1),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, sizes","current-page":t.currentPage,"page-size":t.pageSize,"page-sizes":[10,20,50],total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handlePageChange}})],1)]:[n("el-empty",{attrs:{description:"暂无扫描任务","image-size":120}})]],2)],1)},r=[],s=n("c14f"),c=n("1da1"),i=(n("99af"),n("4d90"),n("b199")),o={name:"VulnerabilityScanner",data:function(){return{taskList:[],total:0,currentPage:1,pageSize:50,source:2,refreshing:!1,showAddTaskDialog:!1,showEditTaskDialog:!1,taskName:"",scanUrl:"",dialogOutputName:"",dialogSelectedFormat:"html",editTask:{id:"",name:"",url:"",output:"",format:"html"}}},mounted:function(){this.loadTaskList()},methods:{formatDate:function(t){if(!t)return"-";var e=new Date(t),n=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),c=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0");return"".concat(n,"-").concat(a,"-").concat(r," ").concat(s,":").concat(c,":").concat(i)},getStatusLabel:function(t){switch(t){case 0:return"待扫描";case 1:return"扫描中";case 2:return"已完成";case 3:return"已停止";default:return"未知状态"}},goToDetail:function(t){this.$router.push("/task/detail/".concat(t.id))},handleSizeChange:function(t){this.pageSize=t,this.currentPage=1,this.loadTaskList()},loadTaskList:function(){var t=this;return Object(c["a"])(Object(s["a"])().m((function e(){var n,a,r;return Object(s["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return t.refreshing=!0,e.p=1,e.n=2,Object(i["e"])(t.currentPage,t.pageSize,t.source);case 2:n=e.v,console.log("后端返回:",n),a=n||n,t.taskList=a.list||[],t.total=a.total||0,e.n=4;break;case 3:e.p=3,r=e.v,console.error(r),t.$message.error("加载任务列表失败");case 4:return e.p=4,t.refreshing=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})))()},refreshTaskList:function(){this.loadTaskList(),this.$message.success("刷新成功")},handlePageChange:function(t){this.currentPage=t,this.loadTaskList()},stopTaskById:function(t){var e=this;return Object(c["a"])(Object(s["a"])().m((function n(){var a;return Object(s["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,Object(i["h"])(t.id);case 1:a=n.v,13e3===a?(e.$message.success("任务已停止"),e.loadTaskList()):e.$message.error("停止失败"),n.n=3;break;case 2:n.p=2,n.v,e.$message.error("停止失败");case 3:return n.a(2)}}),n,null,[[0,2]])})))()},deleteTaskById:function(t){var e=this;return Object(c["a"])(Object(s["a"])().m((function n(){var a;return Object(s["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,Object(i["c"])(t);case 1:a=n.v,1===a?(e.$message.success("任务已删除"),e.loadTaskList()):e.$message.error("删除失败"),n.n=3;break;case 2:n.p=2,n.v,e.$message.error("删除失败");case 3:return n.a(2)}}),n,null,[[0,2]])})))()}}},u=o,l=(n("5209"),n("2877")),d=Object(l["a"])(u,a,r,!1,null,"fa515d0a",null);e["default"]=d.exports},"4d90":function(t,e,n){"use strict";var a=n("23e7"),r=n("0ccb").start,s=n("9a0c");a({target:"String",proto:!0,forced:s},{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},5209:function(t,e,n){"use strict";n("0f97")},"9a0c":function(t,e,n){var a=n("342f");t.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a)},b199:function(t,e,n){"use strict";n.d(e,"e",(function(){return s})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"j",(function(){return l})),n.d(e,"g",(function(){return d})),n.d(e,"f",(function(){return f})),n.d(e,"h",(function(){return g})),n.d(e,"i",(function(){return p}));n("99af"),n("e9c4"),n("ac1f"),n("00b4");var a=n("2ade"),r="api/tasks";function s(t,e,n){return a["a"].get("".concat(r),{params:{page:t,size:e,source:n}})}function c(t){return a["a"].get("".concat(r,"/get"),{params:{taskId:t}})}function i(t){return a["a"].post("".concat(r),t)}function o(t){return a["a"].post("".concat(r,"/batch"),t)}function u(t){var e=/^[0-9]+$/.test(t),n=e?"".concat(r,"/").concat(t):"".concat(r,"/group/").concat(t);return a["a"].delete(n)}function l(t,e){return a["a"].put("".concat(r,"/").concat(t,"/status"),JSON.stringify(e),{headers:{"Content-Type":"application/json"}})}function d(t,e){return a["a"].get("".concat(r,"/").concat(t,"/startTask?source=").concat(e))}function f(t,e){return a["a"].get("".concat(r,"/").concat(t,"/startTaskBygroup?source=").concat(e))}function g(t){var e=/^[0-9]+$/.test(t),n=e?"".concat(r,"/").concat(t,"/stopTask"):"".concat(r,"/stopTaskByGroup");return a["a"].get(n,{params:{id:t}})}function p(t){return a["a"].post("".concat(r,"/task/edit"),t)}},e9c4:function(t,e,n){var a=n("23e7"),r=n("d066"),s=n("d039"),c=r("JSON","stringify"),i=/[\uD800-\uDFFF]/g,o=/^[\uD800-\uDBFF]$/,u=/^[\uDC00-\uDFFF]$/,l=function(t,e,n){var a=n.charAt(e-1),r=n.charAt(e+1);return o.test(t)&&!u.test(r)||u.test(t)&&!o.test(a)?"\\u"+t.charCodeAt(0).toString(16):t},d=s((function(){return'"\\udf06\\ud834"'!==c("\udf06\ud834")||'"\\udead"'!==c("\udead")}));c&&a({target:"JSON",stat:!0,forced:d},{stringify:function(t,e,n){var a=c.apply(null,arguments);return"string"==typeof a?a.replace(i,l):a}})}}]);