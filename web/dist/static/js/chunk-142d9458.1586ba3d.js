(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-142d9458"],{"07ac":function(t,e,n){var a=n("23e7"),r=n("6f53").values;a({target:"Object",stat:!0},{values:function(t){return r(t)}})},"0b45":function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return o})),n.d(e,"a",(function(){return i})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return u}));var a=n("2ade"),r="/api/webhook";function s(){return a["a"].get("".concat(r))}function o(t){return a["a"].get("".concat(r,"/test"),{params:{id:t}})}function i(t){return a["a"].post("".concat(r,"/insert"),t)}function c(t){return a["a"].post("".concat(r,"/update"),t)}function u(t){return a["a"].post("".concat(r,"/delete"),null,{params:{id:t}})}},"0ccb":function(t,e,n){var a=n("50c4"),r=n("1148"),s=n("1d80"),o=Math.ceil,i=function(t){return function(e,n,i){var c,u,l=String(s(e)),d=l.length,f=void 0===i?" ":String(i),p=a(n);return p<=d||""==f?l:(c=p-d,u=r.call(f,o(c/f.length)),u.length>c&&(u=u.slice(0,c)),t?l+u:u+l)}};t.exports={start:i(!1),end:i(!0)}},1148:function(t,e,n){"use strict";var a=n("a691"),r=n("1d80");t.exports="".repeat||function(t){var e=String(r(this)),n="",s=a(t);if(s<0||s==1/0)throw RangeError("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(e+=e))1&s&&(n+=e);return n}},1276:function(t,e,n){"use strict";var a=n("d784"),r=n("44e7"),s=n("825a"),o=n("1d80"),i=n("4840"),c=n("8aa5"),u=n("50c4"),l=n("14c3"),d=n("9263"),f=n("d039"),p=[].push,g=Math.min,h=4294967295,b=!f((function(){return!RegExp(h,"y")}));a("split",2,(function(t,e,n){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var a=String(o(this)),s=void 0===n?h:n>>>0;if(0===s)return[];if(void 0===t)return[a];if(!r(t))return e.call(a,t,s);var i,c,u,l=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),g=0,b=new RegExp(t.source,f+"g");while(i=d.call(b,a)){if(c=b.lastIndex,c>g&&(l.push(a.slice(g,i.index)),i.length>1&&i.index<a.length&&p.apply(l,i.slice(1)),u=i[0].length,g=c,l.length>=s))break;b.lastIndex===i.index&&b.lastIndex++}return g===a.length?!u&&b.test("")||l.push(""):l.push(a.slice(g)),l.length>s?l.slice(0,s):l}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var r=o(this),s=void 0==e?void 0:e[t];return void 0!==s?s.call(e,r,n):a.call(String(r),e,n)},function(t,r){var o=n(a,t,this,r,a!==e);if(o.done)return o.value;var d=s(t),f=String(this),p=i(d,RegExp),m=d.unicode,v=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(b?"y":"g"),k=new p(b?d:"^(?:"+d.source+")",v),w=void 0===r?h:r>>>0;if(0===w)return[];if(0===f.length)return null===l(k,f)?[f]:[];var y=0,S=0,O=[];while(S<f.length){k.lastIndex=b?S:0;var T,j=l(k,b?f:f.slice(S));if(null===j||(T=g(u(k.lastIndex+(b?0:S)),f.length))===y)S=c(f,S,m);else{if(O.push(f.slice(y,S)),O.length===w)return O;for(var _=1;_<=j.length-1;_++)if(O.push(j[_]),O.length===w)return O;S=y=T}}return O.push(f.slice(y)),O}]}),!b)},3695:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"scanner-container"},[n("el-card",{staticClass:"header-card",attrs:{shadow:"hover"}},[n("div",{staticClass:"header"},[n("div",{staticClass:"title-area"},[n("i",{staticClass:"el-icon-aim title-icon"}),n("h2",[t._v("主动扫描任务管理")])]),n("div",{staticClass:"header-buttons"},[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){t.showAddTaskDialog=!0}}},[t._v(" 添加任务 ")]),n("el-button",{attrs:{type:"success",loading:t.refreshing,icon:"el-icon-refresh"},on:{click:t.refreshTaskList}},[t._v(" "+t._s(t.refreshing?"刷新中...":"刷新任务")+" ")])],1)])]),n("el-card",{staticClass:"table-card",attrs:{shadow:"never"}},[n("el-divider",{attrs:{"content-position":"left"}},[n("i",{staticClass:"el-icon-tickets"}),t._v(" 任务列表 ")]),t.taskList.length?[n("el-table",{staticClass:"task-table",attrs:{data:t.taskList,border:"",stripe:"","highlight-current-row":""}},[t.taskList.some((function(t){return t.isGroup}))?n("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-table",{staticStyle:{"margin-left":"50px",width:"90%"},attrs:{data:e.row.urls,size:"small",border:""}},[n("el-table-column",{attrs:{prop:"url",label:"URL"}}),n("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{size:"small",type:1===e.row.status?"warning":2===e.row.status?"success":"info"}},[t._v(" "+t._s(t.getStatusLabel(e.row.status))+" ")])]}}],null,!0)}),n("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[n("el-button",{attrs:{type:"primary",size:"mini",plain:"",icon:"el-icon-view"},on:{click:function(n){return t.goToDetail(a.row,e.row.groupId)}}},[t._v(" 详情 ")])]}}],null,!0)})],1)]}}],null,!1,1683883568)}):t._e(),n("el-table-column",{attrs:{align:"center",label:"ID",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}],null,!1,811300409)}),n("el-table-column",{attrs:{prop:"name",label:"任务/任务组名称","min-width":"180","show-overflow-tooltip":""}}),t.taskList.some((function(t){return t.isGroup}))?t._e():n("el-table-column",{attrs:{prop:"url",label:"扫描URL","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{label:"类型",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{type:"info",size:"small"}},[t._v(t._s(e.row.isGroup?"任务组":"单任务"))])]}}],null,!1,258595387)}),n("el-table-column",{attrs:{label:"状态",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{size:"small",type:1===e.row.status?"warning":2===e.row.status?"success":"info"}},[t._v(" "+t._s(t.getStatusLabel(e.row.status))+" ")])]}}],null,!1,3373575889)}),n("el-table-column",{attrs:{label:"创建时间",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.formatDate(e.row.createtime)))]}}],null,!1,321700122)}),n("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-dropdown",{attrs:{trigger:"click",placement:"bottom"}},[n("el-button",{attrs:{type:"primary",size:"mini",plain:""}},[t._v(" 操作"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{icon:"el-icon-video-play"},nativeOn:{click:function(e){return t.startTaskById(a)}}},[t._v(" 开始 ")]),n("el-dropdown-item",{attrs:{icon:"el-icon-video-pause"},nativeOn:{click:function(e){return t.stopTaskById(a)}}},[t._v(" 停止 ")]),a.isGroup?t._e():n("el-dropdown-item",{attrs:{icon:"el-icon-view"},nativeOn:{click:function(e){return t.goToDetail(a)}}},[t._v(" 查看详情 ")]),n("el-dropdown-item",{attrs:{divided:"",icon:"el-icon-delete"},nativeOn:{click:function(e){return t.deleteTaskById(a.isGroup?a.groupId:a.id)}}},[t._v(" 删除 ")])],1)],1)]}}],null,!1,3886123348)})],1),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, sizes","current-page":t.currentPage,"page-size":t.pageSize,"page-sizes":[10,20,50],total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handlePageChange}})],1)]:[n("el-empty",{attrs:{description:"暂无扫描任务","image-size":120}})]],2),n("el-dialog",{attrs:{title:"添加扫描任务",visible:t.showAddTaskDialog,width:"520px"},on:{"update:visible":function(e){t.showAddTaskDialog=e}}},[n("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[n("el-form-item",{attrs:{label:"任务名称"}},[n("el-input",{attrs:{placeholder:"请输入任务名称"},model:{value:t.taskName,callback:function(e){t.taskName="string"===typeof e?e.trim():e},expression:"taskName"}})],1),n("el-form-item",{attrs:{label:"扫描URL"}},[n("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入扫描URL，每行一个，如果只填一行则为单任务"},model:{value:t.scanUrls,callback:function(e){t.scanUrls=e},expression:"scanUrls"}})],1),n("el-form-item",{attrs:{label:"选择 Webhook"}},[n("el-select",{attrs:{placeholder:"请选择 Webhook ID",clearable:""},model:{value:t.webhookId,callback:function(e){t.webhookId=e},expression:"webhookId"}},t._l(t.webhooks,(function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1),n("span",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.showAddTaskDialog=!1}}},[t._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.submitAddTask}},[t._v("提交")])],1)],1)],1)},r=[],s=n("5530");n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0"),n("a630"),n("fb6a"),n("b0c0"),n("ac1f"),n("00b4"),n("25f0");function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}function i(t,e){if(t){if("string"==typeof t)return o(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function c(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,s=t},f:function(){try{o||null==n["return"]||n["return"]()}finally{if(c)throw s}}}}var u=n("c14f"),l=n("1da1"),d=(n("99af"),n("4de4"),n("d81d"),n("07ac"),n("4d90"),n("1276"),n("498a"),n("0643"),n("2382"),n("a573"),n("b199")),f=n("0b45"),p={name:"VulnerabilityScanner",data:function(){return{taskList:[],total:0,currentPage:1,pageSize:50,source:1,webhookId:null,webhooks:[],refreshing:!1,showAddTaskDialog:!1,showEditTaskDialog:!1,taskName:"",scanUrls:"",dialogOutputName:"",dialogSelectedFormat:"html",editTask:{id:"",name:"",url:"",output:"",format:"html",webhookId:null}}},mounted:function(){this.loadTaskList(),this.loadWebhooks()},methods:{formatDate:function(t){if(!t)return"-";var e=new Date(t),n=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),o=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0");return"".concat(n,"-").concat(a,"-").concat(r," ").concat(s,":").concat(o,":").concat(i)},loadWebhooks:function(){var t=this;return Object(l["a"])(Object(u["a"])().m((function e(){var n,a;return Object(u["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return t.loading=!0,e.p=1,e.n=2,Object(f["c"])();case 2:n=e.v,n&&(t.webhooks=Array.isArray(n)?n:[n]),e.n=4;break;case 3:e.p=3,a=e.v,t.$message.error("加载失败："+a.message);case 4:return e.p=4,t.loading=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})))()},getStatusLabel:function(t){switch(t){case 0:return"待扫描";case 1:return"扫描中";case 2:return"已完成";case 3:return"已停止";default:return"未知状态"}},goToDetail:function(t){this.$router.push("/task/detail/".concat(t.id))},handleSizeChange:function(t){this.pageSize=t,this.currentPage=1,this.loadTaskList()},loadTaskList:function(){var t=this;return Object(l["a"])(Object(u["a"])().m((function e(){var n,a,r,s,o,i,l,f,p;return Object(u["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return t.refreshing=!0,e.p=1,e.n=2,Object(d["e"])(t.currentPage,t.pageSize,t.source);case 2:n=e.v,a=n||n,r=a.list||[],s={},o=c(r);try{for(o.s();!(i=o.n()).done;)l=i.value,l.groupId?(s[l.groupId]||(s[l.groupId]={isGroup:!0,groupId:l.groupId,name:"".concat((null===(f=l.name)||void 0===f?void 0:f.split("-")[0])||"任务组","--(").concat(l.groupId,")"),urls:[],status:l.status,createtime:l.createtime,source:l.source}),s[l.groupId].urls.push(l)):s["single-".concat(l.id)]={isGroup:!1,id:l.id,name:l.name,url:l.url,urls:[{url:l.url,status:l.status}],status:l.status,createtime:l.createtime,source:l.source}}catch(u){o.e(u)}finally{o.f()}t.taskList=Object.values(s),t.total=a.total||0,e.n=4;break;case 3:e.p=3,p=e.v,console.error(p),t.$message.error("加载任务列表失败");case 4:return e.p=4,t.refreshing=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})))()},refreshTaskList:function(){this.loadTaskList(),this.$message.success("刷新成功")},handlePageChange:function(t){this.currentPage=t,this.loadTaskList()},submitAddTask:function(){var t=this;return Object(l["a"])(Object(u["a"])().m((function e(){var n,a,r,s,o,i,c,l;return Object(u["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:if(t.scanUrls&&t.scanUrls.trim()){e.n=1;break}return t.$message.warning("请至少输入一个扫描URL"),e.a(2);case 1:if(n=t.scanUrls.split(/\r?\n/).map((function(t){return t.trim()})).filter((function(t){return""!==t})),0!==n.length){e.n=2;break}return t.$message.warning("URL 不能为空"),e.a(2);case 2:if(e.p=2,a=t.webhookId,1!==n.length){e.n=4;break}return r={name:t.taskName||"任务-".concat(Date.now()),url:n[0],format:t.dialogSelectedFormat||"html",status:0,source:1,webhookid:a},e.n=3,Object(d["b"])(r);case 3:s=e.v,t.$message.success(s?"成功添加 1 个任务":"添加任务失败"),e.n=6;break;case 4:return o=n.map((function(e,n){return{name:t.taskName?"".concat(t.taskName,"-").concat(n+1):"任务-".concat(n+1),url:e,format:t.dialogSelectedFormat||"html",status:0,source:1,webhookid:a}})),e.n=5,Object(d["a"])(o);case 5:i=e.v,c=(null===i||void 0===i?void 0:i.length)||o.length,t.$message.success("成功添加 ".concat(c," 个任务"));case 6:t.showAddTaskDialog=!1,t.taskName="",t.scanUrls="",t.dialogSelectedFormat="html",t.loadTaskList(),e.n=8;break;case 7:e.p=7,l=e.v,console.error(l),t.$message.error("添加任务失败："+l);case 8:return e.a(2)}}),e,null,[[2,7]])})))()},startTaskById:function(t){var e=this;return Object(l["a"])(Object(u["a"])().m((function n(){return Object(u["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:if(n.p=0,console.log("row::::",t),!t.isGroup){n.n=2;break}return n.n=1,Object(d["f"])(t.groupId,t.source);case 1:e.$message.success("任务组已启动"),n.n=4;break;case 2:return n.n=3,Object(d["g"])(t.id,t.source);case 3:e.$message.success("单任务已启动");case 4:e.loadTaskList(),n.n=6;break;case 5:n.p=5,n.v,e.$message.error("启动任务失败");case 6:return n.a(2)}}),n,null,[[0,5]])})))()},stopTaskById:function(t){var e=this;return Object(l["a"])(Object(u["a"])().m((function n(){var a;return Object(u["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,Object(d["h"])(t.groupId);case 1:a=n.v,13e3===a?(e.$message.success("任务已停止"),e.loadTaskList()):e.$message.error("停止失败"),n.n=3;break;case 2:n.p=2,n.v,e.$message.error("停止失败");case 3:return n.a(2)}}),n,null,[[0,2]])})))()},deleteTaskById:function(t){var e=this;return Object(l["a"])(Object(u["a"])().m((function n(){var a;return Object(u["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,Object(d["c"])(t);case 1:a=n.v,1===a||2===a?(e.$message.success("任务已删除"),e.loadTaskList()):e.$message.error("删除失败"),n.n=3;break;case 2:n.p=2,n.v,e.$message.error("删除失败");case 3:return n.a(2)}}),n,null,[[0,2]])})))()},changeStatus:function(t,e){var n=this;return Object(l["a"])(Object(u["a"])().m((function a(){var r;return Object(u["a"])().w((function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,a.n=1,Object(d["j"])(t.id,e);case 1:r=a.v,1===r.data?(n.$message.success("状态已更新"),n.loadTaskList()):n.$message.error("状态更新失败"),a.n=3;break;case 2:a.p=2,a.v,n.$message.error("状态更新失败");case 3:return a.a(2)}}),a,null,[[0,2]])})))()},openEditTaskDialog:function(t){this.editTask=Object(s["a"])(Object(s["a"])({},t),{},{webhookId:t.webhookId||null}),this.showEditTaskDialog=!0},submitEditTask:function(){var t=this;return Object(l["a"])(Object(u["a"])().m((function e(){var n;return Object(u["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:if(t.editTask.name&&t.editTask.url){e.n=1;break}return t.$message.warning("请填写完整信息"),e.a(2);case 1:return e.p=1,e.n=2,Object(d["i"])(t.editTask);case 2:n=e.v,1===n?(t.$message.success("任务修改成功"),t.showEditTaskDialog=!1,t.loadTaskList()):t.$message.error("任务修改失败"),e.n=4;break;case 3:e.p=3,e.v,t.$message.error("任务修改失败");case 4:return e.a(2)}}),e,null,[[1,3]])})))()}}},g=p,h=(n("a491"),n("2877")),b=Object(h["a"])(g,a,r,!1,null,"66695b46",null);e["default"]=b.exports},"40ab":function(t,e,n){},"4d90":function(t,e,n){"use strict";var a=n("23e7"),r=n("0ccb").start,s=n("9a0c");a({target:"String",proto:!0,forced:s},{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},"6f53":function(t,e,n){var a=n("83ab"),r=n("df75"),s=n("fc6a"),o=n("d1e7").f,i=function(t){return function(e){var n,i=s(e),c=r(i),u=c.length,l=0,d=[];while(u>l)n=c[l++],a&&!o.call(i,n)||d.push(t?[n,i[n]]:i[n]);return d}};t.exports={entries:i(!0),values:i(!1)}},"9a0c":function(t,e,n){var a=n("342f");t.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a)},a491:function(t,e,n){"use strict";n("40ab")},b199:function(t,e,n){"use strict";n.d(e,"e",(function(){return s})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"j",(function(){return l})),n.d(e,"g",(function(){return d})),n.d(e,"f",(function(){return f})),n.d(e,"h",(function(){return p})),n.d(e,"i",(function(){return g}));n("99af"),n("e9c4"),n("ac1f"),n("00b4");var a=n("2ade"),r="api/tasks";function s(t,e,n){return a["a"].get("".concat(r),{params:{page:t,size:e,source:n}})}function o(t){return a["a"].get("".concat(r,"/get"),{params:{taskId:t}})}function i(t){return a["a"].post("".concat(r),t)}function c(t){return a["a"].post("".concat(r,"/batch"),t)}function u(t){var e=/^[0-9]+$/.test(t),n=e?"".concat(r,"/").concat(t):"".concat(r,"/group/").concat(t);return a["a"].delete(n)}function l(t,e){return a["a"].put("".concat(r,"/").concat(t,"/status"),JSON.stringify(e),{headers:{"Content-Type":"application/json"}})}function d(t,e){return a["a"].get("".concat(r,"/").concat(t,"/startTask?source=").concat(e))}function f(t,e){return a["a"].get("".concat(r,"/").concat(t,"/startTaskBygroup?source=").concat(e))}function p(t){var e=/^[0-9]+$/.test(t),n=e?"".concat(r,"/").concat(t,"/stopTask"):"".concat(r,"/stopTaskByGroup");return a["a"].get(n,{params:{id:t}})}function g(t){return a["a"].post("".concat(r,"/task/edit"),t)}},e9c4:function(t,e,n){var a=n("23e7"),r=n("d066"),s=n("d039"),o=r("JSON","stringify"),i=/[\uD800-\uDFFF]/g,c=/^[\uD800-\uDBFF]$/,u=/^[\uDC00-\uDFFF]$/,l=function(t,e,n){var a=n.charAt(e-1),r=n.charAt(e+1);return c.test(t)&&!u.test(r)||u.test(t)&&!c.test(a)?"\\u"+t.charCodeAt(0).toString(16):t},d=s((function(){return'"\\udf06\\ud834"'!==o("\udf06\ud834")||'"\\udead"'!==o("\udead")}));o&&a({target:"JSON",stat:!0,forced:d},{stringify:function(t,e,n){var a=o.apply(null,arguments);return"string"==typeof a?a.replace(i,l):a}})}}]);