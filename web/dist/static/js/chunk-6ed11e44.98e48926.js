(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ed11e44"],{"5d9e":function(e,t,n){"use strict";n("bfe2")},bfe2:function(e,t,n){},e4e1:function(e,t,n){"use strict";n.r(t);var c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"config-view"},[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("🛠 工具配置文件管理")])]),n("div",{staticClass:"config-header"},[n("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择配置文件"},on:{change:e.loadConfig},model:{value:e.selectedFile,callback:function(t){e.selectedFile=t},expression:"selectedFile"}},e._l(e.configFiles,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1),n("div",{staticStyle:{"margin-left":"20px"}},[n("el-button",{attrs:{type:"primary",disabled:!e.selectedFile},on:{click:e.saveConfig}},[e._v(" 💾 保存 ")]),n("el-button",{attrs:{type:"success",disabled:!e.selectedFile},on:{click:e.downloadConfig}},[e._v(" 📥 下载 ")]),n("el-button",{attrs:{type:"info"},on:{click:e.toggleFullscreen}},[e._v(" "+e._s(e.isFullscreen?"🧭 退出全屏":"⛶ 全屏编辑")+" ")])],1)],1),n("div",{class:["editor-container",{fullscreen:e.isFullscreen}]},[e.isFullscreen?n("el-button",{staticClass:"exit-fullscreen-btn",attrs:{type:"danger",icon:"el-icon-close",circle:"",size:"small"},on:{click:e.toggleFullscreen}}):e._e(),n("codemirror",{ref:"cm",staticClass:"code-editor",attrs:{options:e.cmOptions},model:{value:e.configContent,callback:function(t){e.configContent=t},expression:"configContent"}})],1)])],1)},r=[],i=n("c14f"),s=n("1da1"),a=(n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("bf19"),n("9861"),n("8f94")),o=(n("a7be"),n("ced0"),n("d2e8"),n("bc3a"),n("e2c1")),l=n("2ade"),u="api/config";function f(){return l["a"].get("".concat(u,"/xray/list"))}function d(e){return l["a"].get("".concat(u,"/xray/view"),{params:e})}function m(e){return l["a"].put("".concat(u,"/save"),e)}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blob";return l["a"].get("".concat(u,"/download"),{params:e,responseType:t})}var p={name:"ToolConfig",components:{codemirror:a["codemirror"]},data:function(){return{configFiles:[],selectedFile:"",configContent:"",isFullscreen:!1,cmOptions:{mode:"yaml",theme:"material",lineNumbers:!0,tabSize:2,lineWrapping:!0,styleActiveLine:!0,indentWithTabs:!1}}},mounted:function(){var e=this;this.$nextTick((function(){if(e.$refs.cm&&e.$refs.cm.codemirror){var t=e.$refs.cm.codemirror;t.refresh();var n=document.querySelector(".editor-container");n&&t.setSize("100%",n.clientHeight+"px")}}))},created:function(){this.fetchConfigFiles()},methods:{fetchConfigFiles:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var n,c;return Object(i["a"])().w((function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,f();case 1:n=t.v,console.log("配置文件列表：",n),e.configFiles=n,t.n=3;break;case 2:t.p=2,c=t.v,e.$message.error("获取配置文件列表失败："+c);case 3:return t.a(2)}}),t,null,[[0,2]])})))()},loadConfig:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var n,c;return Object(i["a"])().w((function(t){while(1)switch(t.p=t.n){case 0:if(e.selectedFile){t.n=1;break}return t.a(2);case 1:return t.p=1,t.n=2,d({filename:e.selectedFile});case 2:n=t.v,e.configContent=n,e.$nextTick((function(){e.$refs.cm&&e.$refs.cm.codemirror&&e.$refs.cm.codemirror.refresh()})),t.n=4;break;case 3:t.p=3,c=t.v,e.$message.error("加载配置文件失败："+c);case 4:return t.a(2)}}),t,null,[[1,3]])})))()},saveConfig:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var n,c;return Object(i["a"])().w((function(t){while(1)switch(t.p=t.n){case 0:t.p=0,o["a"].load(e.configContent),t.n=2;break;case 1:return t.p=1,n=t.v,e.$message.error("YAML 语法错误："+n.message),t.a(2);case 2:return t.p=2,t.n=3,m({filename:e.selectedFile,content:e.configContent});case 3:e.$message.success("保存成功！"),t.n=5;break;case 4:t.p=4,c=t.v,e.$message.error("保存失败："+c);case 5:return t.a(2)}}),t,null,[[2,4],[0,1]])})))()},downloadConfig:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var n,c,r,s;return Object(i["a"])().w((function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,b({filename:e.selectedFile},"blob");case 1:n=t.v,c=window.URL.createObjectURL(new Blob([n])),r=document.createElement("a"),r.href=c,r.setAttribute("download",e.selectedFile),document.body.appendChild(r),r.click(),r.remove(),t.n=3;break;case 2:t.p=2,s=t.v,e.$message.error("下载失败："+s);case 3:return t.a(2)}}),t,null,[[0,2]])})))()},toggleFullscreen:function(){var e=this;this.isFullscreen=!this.isFullscreen,this.$nextTick((function(){if(window.dispatchEvent(new Event("resize")),e.$refs.cm&&e.$refs.cm.codemirror){var t=e.$refs.cm.codemirror;t.refresh();var n=document.querySelector(".editor-container");n&&t.setSize("100%",n.clientHeight+"px")}}))}}},v=p,g=(n("5d9e"),n("2877")),h=Object(g["a"])(v,c,r,!1,null,"a3c765f4",null);t["default"]=h.exports}}]);