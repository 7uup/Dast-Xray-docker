(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-55a369a5"],{"13d5":function(e,t,r){"use strict";var a=r("23e7"),n=r("d58f").left,i=r("a640"),c=r("ae40"),o=i("reduce"),s=c("reduce",{1:0});a({target:"Array",proto:!0,forced:!o||!s},{reduce:function(e){return n(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"1c31":function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return c})),r.d(t,"a",(function(){return o}));var a=r("2ade"),n="api/report";function i(e,t,r){return a["a"].get("".concat(n,"/list"),{params:{page:e,size:t,source:r}})}function c(e,t){return a["a"].get("".concat(n,"/view"),{params:{id:e,task_id:t}})}function o(e,t,r){return a["a"].delete("".concat(n,"/delete"),{params:{path:e,task_id:t,id:r}})}},"9d46":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"report-view"},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("漏洞报告管理")]),r("div",{staticStyle:{float:"right"}},[r("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"输入任务名搜索",size:"small",clearable:""},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.fetchReports}},[e._v("搜索")])],1)]),r("el-collapse",{attrs:{accordion:""},model:{value:e.activeDomain,callback:function(t){e.activeDomain=t},expression:"activeDomain"}},e._l(e.groupedReports,(function(t,a){return r("el-collapse-item",{key:a,attrs:{name:a}},[r("template",{slot:"title"},[r("i",{staticClass:"el-icon-folder"}),r("span",{staticStyle:{"margin-left":"8px"}},[e._v(e._s(a))]),r("span",{staticStyle:{color:"gray","font-size":"13px","margin-left":"8px"}},[e._v(" （"+e._s(t[0].url)+"） ")])]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t,size:"small",border:""}},[r("el-table-column",{attrs:{prop:"report_path",label:"报告路径"}}),r("el-table-column",{attrs:{prop:"create_time",label:"生成时间",width:"180"}}),r("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(r){return e.viewReport(t.row.id,t.row.task_id)}}},[e._v(" 查看 ")]),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.deleteReport(t.row)}}},[e._v(" 删除 ")])]}}],null,!0)})],1)],2)})),1),r("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.page,"page-size":e.size},on:{"current-change":e.fetchReports}}),r("el-dialog",{attrs:{visible:e.dialogVisible,fullscreen:"","custom-class":"report-dialog","show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("div",{staticClass:"report-header"},[r("span",{staticClass:"report-title"},[e._v("漏洞报告预览")]),r("el-button",{attrs:{type:"danger",icon:"el-icon-close",size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(" 关闭报告 ")])],1),e.reportHtml?r("iframe",{staticClass:"report-iframe",attrs:{srcdoc:e.reportHtml,frameborder:"0"}}):e._e()])],1)],1)},n=[],i=r("c14f"),c=r("1da1"),o=(r("13d5"),r("b0c0"),r("d3b7"),r("0643"),r("9d4a"),r("1c31")),s={name:"ActiveReport",data:function(){return{page:1,size:10,source:2,activeDomain:"",reports:[],groupedReports:{},dialogVisible:!1,reportHtml:"",reportCache:{},keyword:""}},created:function(){this.fetchReports()},methods:{fetchReports:function(){var e=arguments,t=this;return Object(c["a"])(Object(i["a"])().m((function r(){var a,n,c,s,l;return Object(i["a"])().w((function(r){while(1)switch(r.p=r.n){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:t.page,n=e.length>1&&void 0!==e[1]?e[1]:t.size,c=e.length>2&&void 0!==e[2]?e[2]:t.source,r.p=1,r.n=2,Object(o["b"])(a,n,c);case 2:s=r.v,t.reports=s||[],t.groupedReports=t.reports.reduce((function(e,t){var r=t.groupId?"任务组-".concat(t.groupId):t.name||"单任务";return e[r]||(e[r]=[]),e[r].push(t),e}),{}),t.page=a,r.n=4;break;case 3:r.p=3,l=r.v,t.$message.error("加载报告失败："+l);case 4:return r.a(2)}}),r,null,[[1,3]])})))()},viewReport:function(e,t){var r=this;return Object(c["a"])(Object(i["a"])().m((function a(){var n,c;return Object(i["a"])().w((function(a){while(1)switch(a.p=a.n){case 0:if(a.p=0,!r.reportCache[e]){a.n=1;break}return r.reportHtml=r.reportCache[e],r.dialogVisible=!0,a.a(2);case 1:return a.n=2,Object(o["c"])(e,t);case 2:n=a.v,r.reportHtml=n,r.dialogVisible=!0,r.reportCache[e]=n,a.n=4;break;case 3:a.p=3,c=a.v,r.$message.error("读取报告失败："+c);case 4:return a.a(2)}}),a,null,[[0,3]])})))()},deleteReport:function(e){var t=this;return Object(c["a"])(Object(i["a"])().m((function r(){return Object(i["a"])().w((function(r){while(1)switch(r.n){case 0:t.$confirm('确定删除报告 "'.concat(e.report_path,'" 吗？'),"提示",{type:"warning"}).then(Object(c["a"])(Object(i["a"])().m((function r(){var a,n;return Object(i["a"])().w((function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,Object(o["a"])(e.report_path,e.task_id,e.id);case 1:a=r.v,a&&!1!==a.success?(t.$message.success("删除成功"),t.reportCache[e.id]=null,t.fetchReports()):t.$message.error("删除失败："+(a.message||"")),r.n=3;break;case 2:r.p=2,n=r.v,t.$message.error("删除请求失败："+n);case 3:return r.a(2)}}),r,null,[[0,2]])})))).catch((function(){}));case 1:return r.a(2)}}),r)})))()}}},l=s,u=(r("ef2b"),r("2877")),p=Object(u["a"])(l,a,n,!1,null,"3a0667ce",null);t["default"]=p.exports},"9d4a":function(e,t,r){"use strict";var a=r("23e7"),n=r("2266"),i=r("1c0b"),c=r("825a");a({target:"Iterator",proto:!0,real:!0},{reduce:function(e){c(this),i(e);var t=arguments.length<2,r=t?void 0:arguments[1];if(n(this,(function(a){t?(t=!1,r=a):r=e(r,a)}),void 0,!1,!0),t)throw TypeError("Reduce of empty iterator with no initial value");return r}})},c122:function(e,t,r){},d58f:function(e,t,r){var a=r("1c0b"),n=r("7b0b"),i=r("44ad"),c=r("50c4"),o=function(e){return function(t,r,o,s){a(r);var l=n(t),u=i(l),p=c(l.length),d=e?p-1:0,f=e?-1:1;if(o<2)while(1){if(d in u){s=u[d],d+=f;break}if(d+=f,e?d<0:p<=d)throw TypeError("Reduce of empty array with no initial value")}for(;e?d>=0:p>d;d+=f)d in u&&(s=r(s,u[d],d,l));return s}};e.exports={left:o(!1),right:o(!0)}},ef2b:function(e,t,r){"use strict";r("c122")}}]);